---
title: Reduxè®¾è®¡æ€æƒ³ä¸å·¥ä½œåŸç†
date: 2022-10-24
excerpt: æœ¬æ–‡å¯¹Reduxæ ¸å¿ƒæ€æƒ³å’Œå·¥ä½œåŸç†è¿›è¡Œæ€»ç»“ï¼Œè™½ç„¶æ²¡æœ‰å®é™…çš„ä»£ç ä¾‹å­ï¼Œä½†å¸Œæœ›èƒ½å¸®åŠ©ä½ äº†è§£Reduxã€‚
cover: /2022-10-24-23-13-42.png
tags:
- Redux
- JavaScript
- State Management
---

## Redux

### ä»€ä¹ˆæ˜¯Reduxï¼Ÿ

åœ¨å®˜æ–¹æ–‡æ¡£é‡Œï¼Œç»™å‡ºäº†è¿™æ ·ä¸€ä¸ªå®šä¹‰

> Redux is a predictable state container for JavaScript apps. It helps you write applications that behave consistently

Reduxæ˜¯ä¸ºJavascriptåº”ç”¨æä¾›ä¸€ä¸ªå¯é¢„æµ‹çš„çŠ¶æ€å®¹å™¨ğŸ“¦

> Redux is a pattern and library for managing and updating application state, using events called "actions". 

Reduxä»£è¡¨ä¸€ç§æ•°æ®æµæ¨¡å¼ï¼Œæ˜¯ä¸€ç§é€šè¿‡â€œactionsâ€çš„äº‹ä»¶æ¥ç®¡ç†å’Œæ›´æ–°åº”ç”¨çŠ¶æ€çš„åº“ğŸ“šã€‚

è¯»åˆ°è¿™é‡Œå¯èƒ½å¤§å®¶è¿˜æ˜¯ä¸€å¤´é›¾æ°´ï¼Œå®ƒåº”ç”¨åœºæ™¯æ˜¯å•¥ï¼Ÿä¸ºä»€ä¹ˆè¦ç”¨Reduxï¼Ÿå°±è¿Reduxçš„ä½œè€… Dan å°±æ›¾å‘è¨€è­¦å‘Šè¯´ï¼Œè¿‡æ—©çš„å¼•å…¥Reduxå¯èƒ½å­˜åœ¨é£é™© [*You Might Not Need Redux*](https://medium.com/@dan_abramov/you-might-not-need-redux-be46360cf367)ã€‚

ç©¶å…¶åŸå› ï¼Œä¸»è¦æ˜¯Reduxæœ‰å¤ªå¤šæ¦‚å¿µéœ€è¦å­¦ä¹ äº†ï¼Œéœ€è¦å†™å¾ˆå¤šverboseä»£ç ï¼Œå¹¶ä¸”è¦æ±‚ä½ éµå®ˆæŸäº›é™åˆ¶ã€‚

é™¤é

- çŠ¶æ€æ›´æ–°çš„é€»è¾‘å¼‚å¸¸å¤æ‚
- çŠ¶æ€éœ€è¦é¢‘ç¹çš„æ›´æ–°
- åº”ç”¨ä¸­å†…éƒ¨æœ‰å¾ˆå¤šå…±äº«çš„çŠ¶æ€
- ä½ æ­£åœ¨æ„å»ºä¸€ä¸ªè¾ƒå¤§çš„åº”ç”¨ï¼Œå¹¶ä¸”æœ‰è¾ƒå¤§çš„å›¢é˜Ÿè§„æ¨¡

å¦‚æœè¯´ä¸Šè¿°å››æ¡æ²¡æœ‰ä¸€æ¡æ»¡è¶³ï¼Œé‚£ä¹ˆç›¸ä¿¡æˆ‘ï¼Œå¼•å…¥Reduxä¸æ˜¯ä¸€ä¸ªæ˜æ™ºçš„é€‰æ‹©ã€‚

### Redux æ ¸å¿ƒæ¦‚å¿µ

Redux å®é™…ä¸Šæ˜¯ Flux çš„ä¸€ç§å®ç°å½¢å¼ã€‚

Flux æ˜¯ä¸€å¥—å¤„ç†æ•°æ®çš„æ¶æ„æ¨¡å¼ï¼Œæ ¸å¿ƒç‰¹å¾æ˜¯å•å‘æ•°æ®æµï¼Œ çŠ¶æ€çš„å˜åŒ–æ˜¯å¯é¢„æµ‹çš„ã€‚

1. View
   ç”¨æˆ·ç•Œé¢
2. Action
   è¯•å›¾å±‚å‘å‡ºçš„ä¿¡æ¯ï¼Œä¼šè§¦å‘åº”ç”¨çŠ¶æ€åº¦æ”¹å˜
3. Dispatcher
   åˆ†å‘Action
4. Store
   å­˜å‚¨åº”ç”¨çŠ¶æ€çš„ä»“åº“ï¼Œå®šä¹‰ä¿®æ”¹çŠ¶æ€çš„é€»è¾‘

Reduxç»è¿‡é‡æ–°è®¾è®¡å’Œæ”¹è‰¯ï¼Œä¸»è¦ç”±å››ä¸ªæ ¸å¿ƒæ¦‚å¿µç»„æˆï¼š

1. Storeï¼šåªè¯»çš„å•ä¸€æ•°æ®æº
2. Actionï¼šå¯¹å˜åŒ–çš„æè¿°
3. Reducerï¼šReduceræ˜¯çº¯å‡½æ•°ï¼Œè´Ÿè´£å¯¹å˜åŒ–è¿›è¡Œåˆ†åŒ–å’Œå¤„ç†ï¼ŒæŠŠæ–°çš„çŠ¶æ€è¿”å›ç»™Storeã€‚
4. Dispatcherï¼šè´Ÿè´£åˆ†å‘Action

Reduxçš„å·¥ä½œæµğŸŒŠ

![redux-work-flow](redux-work-flow.gif)

Redux æœŸæœ›æ‰€æœ‰çš„çŠ¶æ€æ›´æ–°éƒ½æ˜¯ immutable çš„ã€‚ è‡³äºä¸ºä»€ä¹ˆè¦ immutable å¯ä»¥çœ‹çœ‹æˆ‘çš„è¿™ç¯‡æ–‡ç«  [ä¸ºä»€ä¹ˆè¯´immutableå¾ˆé‡è¦](https://ruoyu.life/blog/post/study/%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AF%B4immutable%E5%BE%88%E9%87%8D%E8%A6%81)



### ä¸­é—´ä»¶

ä¸­é—´ä»¶çš„ä»‹å…¥å…è®¸Dispatcherä¸ä»…å¯ä»¥ä¼ é€’ä¸€ä¸ªæ™®é€šactionå¯¹è±¡ï¼Œè¿˜å¯ä»¥ä¼ é€’ä¸€ä¸ªå‡½æ•°

ä¸€æ—¦é€šè¿‡dispatchè¢«ä¼ é€’çš„ value æŠµè¾¾äº†ä¸­é—´ä»¶ï¼Œå®ƒä¾¿å¯ä»¥é€šè¿‡å¼‚æ­¥çš„æ–¹å¼æ¥æ‰§è¡Œï¼Œå¦‚å‘é€AJAXè¯·æ±‚ç­‰ï¼Œç­‰å“åº”ä¹‹åå†dispatchä¸€ä¸ªactionæ¥è§¦å‘reducerè¿›è¡Œå¤„ç†

æ¢å¥è¯è¯´ï¼ŒapplyMiddlewareä¼šå¯¹dispatchå‡½æ•°è¿›è¡Œæ”¹å†™ï¼Œä½¿dispatchåœ¨å‡ºå‘reducerä¹‹å‰å…ˆè¦å¯¹ä¸­é—´ä»¶è¿›è¡Œé“¾å¼è°ƒç”¨


```JavaScript
function createThunkMiddleware(extraArgument){
    return ({dispatch,getState}) => next => action => {
        if (typeof action === 'function') {
            return action(dispatch,getState,extraArgument)
        }
        return next(action)
    }
}
```


![redux-middleware](redux.gif)


## ç»“è¯­

å°½ç®¡å®ƒå¾ˆç«ï¼Œæœ‰å¾ˆå¤šå¤§å…¬å¸éƒ½åœ¨ä½¿ç”¨ Reduxï¼Œ ä½†è¿™ä¸ä»£è¡¨ä½ çš„åº”ç”¨å°±éœ€è¦å®ƒã€‚å‡¡äº‹éƒ½éœ€è¦æƒè¡¡ï¼ˆtradeoffï¼‰ã€‚è¯·æ–Ÿé…Œè€ƒè™‘ï¼Œå½“ä½ èŠ±äº†ç²¾åŠ›ï¼ŒRedux æ˜¯ä¸æ˜¯çœŸçš„å¯ä»¥ç»™ä½ çš„é¡¹ç›®å¸¦æ¥å›æŠ¥ï¼Ÿ